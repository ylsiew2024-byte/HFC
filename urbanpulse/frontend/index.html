<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MetroMind - Smart Transit AI</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">üöá</span>
                <h1>MetroMind</h1>
            </div>
            <p class="tagline">Multi-Agent Transit Intelligence for Singapore</p>
            <div class="header-stats">
                <div class="stat-pill liveability-pill">
                    <span class="stat-label">Liveability</span>
                    <span class="stat-value" id="header-liveability">--</span>
                </div>
                <div class="stat-pill environment-pill">
                    <span class="stat-label">Environment</span>
                    <span class="stat-value" id="header-environment">--</span>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <main class="dashboard">
            <!-- Left Panel: Map -->
            <section class="map-panel">
                <div class="panel-header">
                    <h2>Singapore Transit Map</h2>
                    <div class="time-display">
                        <span class="time-icon" id="time-icon">üåô</span>
                        <span class="time-text" id="clock-time">12:00 AM</span>
                        <span class="time-period" id="clock-period">Night</span>
                    </div>
                </div>

                <!-- Singapore Map SVG - Realistic Shape -->
                <div class="map-container">
                    <svg viewBox="0 0 450 280" class="singapore-map" id="sg-map">
                        <!-- Background -->
                        <defs>
                            <linearGradient id="water-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#1a365d;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#2c5282;stop-opacity:1" />
                            </linearGradient>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                <feMerge>
                                    <feMergeNode in="coloredBlur"/>
                                    <feMergeNode in="SourceGraphic"/>
                                </feMerge>
                            </filter>
                            <!-- Drop shadow for island -->
                            <filter id="island-shadow" x="-10%" y="-10%" width="120%" height="120%">
                                <feDropShadow dx="2" dy="2" stdDeviation="3" flood-color="#000" flood-opacity="0.5"/>
                            </filter>
                        </defs>

                        <!-- Water background -->
                        <rect width="450" height="280" fill="url(#water-gradient)"/>

                        <!-- Malaysia (Johor) hint at top -->
                        <path d="M20,0 L430,0 L430,35 Q350,45 280,40 Q200,35 120,42 Q60,48 20,35 Z"
                              fill="#1e3a5f" opacity="0.5"/>
                        <text x="225" y="20" fill="#4a5568" font-size="9" text-anchor="middle">JOHOR, MALAYSIA</text>

                        <!-- Straits of Johor -->
                        <path d="M20,35 Q120,45 200,40 Q300,35 430,45 L430,55 Q300,50 200,55 Q100,60 20,50 Z"
                              fill="#1a4971" opacity="0.6"/>

                        <!-- North Region - Woodlands/Sembawang/Yishun -->
                        <g class="district" id="district-north" data-district="North">
                            <path d="M100,55 Q150,50 200,52 Q260,50 320,55 L340,75 Q320,90 280,95 L250,100 Q200,98 150,100 L120,95 Q90,85 80,70 Z"
                                  class="district-shape" fill="#2d3748" filter="url(#island-shadow)"/>
                            <text x="200" y="72" class="district-label">NORTH</text>
                            <text x="200" y="85" class="district-stats" id="north-stats">--</text>
                            <!-- Woodlands Checkpoint marker -->
                            <circle cx="180" cy="58" r="4" fill="#f6e05e" opacity="0.8"/>
                            <text x="180" y="61" font-size="5" fill="#1a202c" text-anchor="middle" font-weight="bold">WL</text>
                            <g class="district-icons" id="north-icons"></g>
                        </g>

                        <!-- West Region - Jurong/Tuas -->
                        <g class="district" id="district-west" data-district="West">
                            <path d="M25,100 L80,70 L120,95 L150,100 L155,135 Q145,165 120,180 L80,195 Q45,185 30,165 L20,140 Q15,120 25,100 Z"
                                  class="district-shape" fill="#2d3748" filter="url(#island-shadow)"/>
                            <text x="85" y="135" class="district-label">WEST</text>
                            <text x="85" y="150" class="district-stats" id="west-stats">--</text>
                            <!-- Tuas marker -->
                            <text x="35" y="160" class="poi-marker" font-size="12">üè≠</text>
                            <g class="district-icons" id="west-icons"></g>
                        </g>

                        <!-- Central Region - CBD/Orchard/Novena -->
                        <g class="district" id="district-central" data-district="Central">
                            <path d="M150,100 L250,100 L280,95 Q295,105 300,120 L305,145 Q295,175 270,190 L220,200 L170,195 Q145,180 140,160 L145,130 Q148,110 150,100 Z"
                                  class="district-shape central" fill="#2d3748" filter="url(#island-shadow)"/>
                            <text x="220" y="140" class="district-label">CENTRAL</text>
                            <text x="220" y="155" class="district-stats" id="central-stats">--</text>
                            <!-- CBD/Marina Bay marker -->
                            <circle cx="235" cy="175" r="10" class="cbd-marker"/>
                            <text x="235" y="178" class="cbd-text">CBD</text>
                            <!-- Orchard marker -->
                            <circle cx="190" cy="145" r="5" fill="#ed8936" opacity="0.7"/>
                            <text x="190" y="147" font-size="5" fill="#fff" text-anchor="middle">üõçÔ∏è</text>
                            <g class="district-icons" id="central-icons"></g>
                        </g>

                        <!-- East Region - Tampines/Changi/Bedok -->
                        <g class="district" id="district-east" data-district="East">
                            <path d="M280,95 L340,75 Q380,85 410,100 L430,130 Q440,160 420,185 L380,200 Q340,210 300,195 L270,190 Q295,175 305,145 L300,120 Q295,105 280,95 Z"
                                  class="district-shape" fill="#2d3748" filter="url(#island-shadow)"/>
                            <text x="355" y="140" class="district-label">EAST</text>
                            <text x="355" y="155" class="district-stats" id="east-stats">--</text>
                            <!-- Changi Airport marker -->
                            <text x="410" y="155" class="poi-marker" font-size="16">‚úàÔ∏è</text>
                            <text x="410" y="170" font-size="7" fill="#a0aec0" text-anchor="middle">Changi</text>
                            <g class="district-icons" id="east-icons"></g>
                        </g>

                        <!-- South Region - Harbourfront/Sentosa area -->
                        <g class="district" id="district-south" data-district="South">
                            <path d="M120,180 Q145,180 170,195 L220,200 L270,190 Q300,195 300,210 Q290,235 250,240 L200,245 Q150,245 120,235 Q90,225 80,210 L80,195 Q95,185 120,180 Z"
                                  class="district-shape" fill="#2d3748" filter="url(#island-shadow)"/>
                            <text x="190" y="215" class="district-label">SOUTH</text>
                            <text x="190" y="230" class="district-stats" id="south-stats">--</text>
                            <g class="district-icons" id="south-icons"></g>
                        </g>

                        <!-- Sentosa Island (separate) -->
                        <g class="sentosa" opacity="0.9">
                            <ellipse cx="175" cy="260" rx="30" ry="12" fill="#2d3748" filter="url(#island-shadow)"/>
                            <text x="175" y="258" class="poi-marker" font-size="14">üèùÔ∏è</text>
                            <text x="175" y="272" font-size="7" fill="#a0aec0" text-anchor="middle">Sentosa</text>
                        </g>

                        <!-- MRT Lines -->
                        <g class="mrt-lines">
                            <!-- North-South Line (Red) -->
                            <path d="M180,58 Q185,75 200,95 Q210,130 235,175"
                                  class="mrt-line ns-line" fill="none" stroke-dasharray="3,2"/>
                            <!-- East-West Line (Green) -->
                            <path d="M35,145 Q60,150 85,148 Q150,145 190,148 Q280,155 355,150 Q400,145 420,150"
                                  class="mrt-line ew-line" fill="none" stroke-dasharray="3,2"/>
                            <!-- Circle Line hint (Orange) -->
                            <ellipse cx="220" cy="145" rx="40" ry="30"
                                  fill="none" stroke="#ed8936" stroke-width="2" stroke-dasharray="3,2" opacity="0.4"/>
                        </g>

                        <!-- Animation layer for +1 indicators -->
                        <g id="animation-layer"></g>
                    </svg>

                    <!-- Map Legend -->
                    <div class="map-legend">
                        <div class="legend-item">
                            <span class="legend-color good"></span>
                            <span>Low Load</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color moderate"></span>
                            <span>Moderate</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color busy"></span>
                            <span>Busy</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color critical"></span>
                            <span>Critical</span>
                        </div>
                    </div>
                </div>

                <!-- Day Counter -->
                <div class="day-counter">
                    <span class="day-label">Day</span>
                    <span class="day-value" id="day-count">1</span>
                    <span class="hour-label">Hour</span>
                    <span class="hour-value" id="hour-count">0</span>
                </div>
            </section>

            <!-- Center Panel: Controls & Metrics -->
            <section class="control-panel">
                <div class="controls">
                    <button id="btn-step" onclick="step()" class="btn btn-primary">
                        <span class="btn-icon">‚ñ∂</span>
                        <span class="btn-text">Next Hour</span>
                    </button>
                    <button id="btn-run10" onclick="run10()" class="btn btn-secondary">
                        <span class="btn-icon">‚è©</span>
                        <span class="btn-text">Skip 10h</span>
                    </button>
                    <button id="btn-reset" onclick="reset()" class="btn btn-danger">
                        <span class="btn-icon">‚Ü∫</span>
                        <span class="btn-text">Reset</span>
                    </button>
                </div>

                <!-- Economic Status -->
                <div class="budget-display">
                    <h3>üí∞ City Treasury</h3>
                    <div class="treasury-display">
                        <div class="treasury-main">
                            <span class="treasury-label">Funds</span>
                            <span class="treasury-value" id="city-funds">$1,000K</span>
                        </div>
                        <div class="treasury-flow">
                            <span class="flow-item income">+$<span id="hourly-revenue">0</span>/hr</span>
                            <span class="flow-item expense">-$<span id="hourly-cost">0</span>/hr</span>
                        </div>
                    </div>
                    <div class="budget-bars">
                        <div class="budget-item">
                            <span class="budget-icon">üöå</span>
                            <span class="budget-label">Buses</span>
                            <div class="budget-bar">
                                <div class="budget-fill bus-fill" id="bus-budget-bar"></div>
                            </div>
                            <span class="budget-value" id="bus-budget-value">40/40</span>
                        </div>
                        <div class="budget-item">
                            <span class="budget-icon">üöá</span>
                            <span class="budget-label">Trains</span>
                            <div class="budget-bar">
                                <div class="budget-fill mrt-fill" id="mrt-budget-bar"></div>
                            </div>
                            <span class="budget-value" id="mrt-budget-value">12/12</span>
                        </div>
                    </div>
                </div>

                <!-- Environmental Status -->
                <div class="environment-display">
                    <h3>üåç Environmental Health</h3>
                    <div class="env-stats">
                        <div class="env-item">
                            <span class="env-icon">üå±</span>
                            <span class="env-label">Sustainability</span>
                            <div class="env-bar">
                                <div class="env-fill sustainability-fill" id="sustainability-bar"></div>
                            </div>
                            <span class="env-value" id="sustainability-value">100</span>
                        </div>
                        <div class="env-item">
                            <span class="env-icon">üí®</span>
                            <span class="env-label">CO‚ÇÇ This Hour</span>
                            <span class="env-value emissions" id="hourly-emissions">0 kg</span>
                        </div>
                        <div class="env-item">
                            <span class="env-icon">üè≠</span>
                            <span class="env-label">Total Emissions</span>
                            <span class="env-value emissions" id="total-emissions">0 kg</span>
                        </div>
                    </div>
                </div>

                <!-- Active Events -->
                <div class="events-display" id="events-container">
                    <h3>‚ö° Active Events</h3>
                    <div class="events-list" id="events-list">
                        <div class="no-events">No active events</div>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="metrics-compact">
                    <h3>City Vitals</h3>
                    <div class="metric-row">
                        <div class="metric-item">
                            <span class="metric-icon">üöâ</span>
                            <span class="metric-label">Station Crowding</span>
                            <span class="metric-value" id="metric-station">--</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-icon">üöå</span>
                            <span class="metric-label">Bus Load</span>
                            <span class="metric-value" id="metric-bus">--</span>
                        </div>
                    </div>
                    <div class="metric-row">
                        <div class="metric-item">
                            <span class="metric-icon">üöá</span>
                            <span class="metric-label">MRT Load</span>
                            <span class="metric-value" id="metric-mrt">--</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-icon">üöó</span>
                            <span class="metric-label">Traffic</span>
                            <span class="metric-value" id="metric-traffic">--</span>
                        </div>
                    </div>
                    <div class="metric-row single">
                        <div class="metric-item">
                            <span class="metric-icon">üåø</span>
                            <span class="metric-label">Air Quality</span>
                            <span class="metric-value" id="metric-air">--</span>
                        </div>
                    </div>
                </div>

                <!-- Score History Chart -->
                <div class="chart-section">
                    <h3>Performance Trend</h3>
                    <div class="chart-container">
                        <canvas id="score-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Right Panel: Agents & Actions -->
            <section class="agent-panel">
                <!-- Agent Status -->
                <div class="agent-status">
                    <h2>ü§ñ Agent Orchestra</h2>
                    <div class="agents-grid">
                        <div class="agent-card" id="agent-monitor">
                            <div class="agent-icon">üëÅÔ∏è</div>
                            <div class="agent-info">
                                <span class="agent-name">Monitor</span>
                                <span class="agent-state" id="monitor-state">Idle</span>
                            </div>
                            <div class="agent-indicator"></div>
                        </div>
                        <div class="agent-card" id="agent-planner">
                            <div class="agent-icon">üìã</div>
                            <div class="agent-info">
                                <span class="agent-name">Planner</span>
                                <span class="agent-state" id="planner-state">Idle</span>
                            </div>
                            <div class="agent-indicator"></div>
                        </div>
                        <div class="agent-card" id="agent-policy">
                            <div class="agent-icon">‚öñÔ∏è</div>
                            <div class="agent-info">
                                <span class="agent-name">Policy</span>
                                <span class="agent-state" id="policy-state">Idle</span>
                            </div>
                            <div class="agent-indicator"></div>
                        </div>
                        <div class="agent-card" id="agent-coordinator">
                            <div class="agent-icon">üéØ</div>
                            <div class="agent-info">
                                <span class="agent-name">Coordinator</span>
                                <span class="agent-state" id="coordinator-state">Idle</span>
                            </div>
                            <div class="agent-indicator"></div>
                        </div>
                        <div class="agent-card" id="agent-executor">
                            <div class="agent-icon">‚ö°</div>
                            <div class="agent-info">
                                <span class="agent-name">Executor</span>
                                <span class="agent-state" id="executor-state">Idle</span>
                            </div>
                            <div class="agent-indicator"></div>
                        </div>
                    </div>
                </div>

                <!-- Action Feed -->
                <div class="action-feed">
                    <h2>üì° Live Interventions</h2>
                    <div id="action-list" class="action-list">
                        <div class="action-placeholder">
                            <span class="placeholder-icon">üöÄ</span>
                            <span>Run simulation to see agent decisions</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <span>MetroMind</span>
            <span class="separator">‚Ä¢</span>
            <span>Multi-Agent Transit AI</span>
            <span class="separator">‚Ä¢</span>
            <span>Singapore 2024</span>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
